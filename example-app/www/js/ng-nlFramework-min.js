angular.module("nlFramework",[]).factory("$nlFramework",["$nlConfig","$nlDrawer","$nlBurger","$nlRefresh","$nlToast","$nlMenu",function(t,e,n,o,i,r){var s={drawer:e,burger:n,refresh:o,toast:i,menu:r,config:t,set:function(e){var n=t.options;t.options=$nlHelpers.merge(n,e)}};return s}]).factory("$nlElements",function(){var t={};return t}).factory("$nlConfig",function(){return{openned:!1,plusActive:!1,holdPos:null,reverse:!1,scroll:{},nlRefresh:{},options:{maxWidth:300,topBarHeight:56,speed:.2,animation:"ease",modifyViewContent:!0,useActionButton:!0,refresh:{activeColor:"#558844",defaultColor:"#aa3344"},burger:{endY:6,startScale:1,endScale:.7}}}}).factory("$nlHelpers",function(){return{translate:function(t,e,n,o,i,r,s,a,l,d,c){var e=e||0,o=o||0,n=n||"",i=i||"",s=s||"",a=a||!1,u=t;l="nlRefresh"===u.id?l?"scale3d("+l+","+l+",1)":"scale3d(1,1,1)":l?"scale3d("+l+",1,1)":"","burger-top"===u.id?u.style.transformOrigin="100% 100%":"burger-bottom"===u.id&&(u.style.transformOrigin="100% 0%"),u.style.transform="translate3d("+n+e+"px, "+i+o+"px, 0) rotate3d( 0, 0, 1, "+s+r+"deg ) "+l,u.style.webkitTransform="translate("+n+e+"px, "+i+o+"px) translateZ(0) rotate("+s+r+"deg) "+l,a&&(u.style.width=a+"px"),c&&(u.style.opacity=c),a&&(u.style["max-width"]=a+"px"),d&&(u.style.msTransform=u.style.MozTransform=u.style.OTransform="translateX("+n+e+"px) translateY("+i+o+"px) rotate("+s+r+"deg)")},merge:function(t,e){var n={};for(var o in t)n[o]=t[o];for(var o in e)n[o]=e[o];return n}}}).factory("$nlBurger",["$nlConfig","$nlHelpers","$nlElements",function(t,e,n){return{animate:function(o){var i=t.maxWidth,r=i-Math.abs(o),s=Math.floor(100/i*r);if(s>0){var a=t.options.burger.startScale-Math.abs((1-t.options.burger.endScale)/100*s).toFixed(2),l=Math.floor(.45*s),d=Math.floor(t.options.burger.endY/100*s);d=y_pos_bottom=d<t.options.burger.endY?d:t.options.burger.endY;var c=Math.floor(1.8*s);t.options.reverse&&(c=180+(180-c)),n.burger.style.transition="none",n.burgerTop.style.transition="none",n.burgerBottom.style.transition="none",e.translate(n.burger,0,"",0,"",c,"",""),e.translate(n.burgerTop,0,"",d,"",l,"","",a),e.translate(n.burgerBottom,0,"",y_pos_bottom,"-",l,"-","",a)}},toggle:function(o){n.burger.style.transition="all "+t.options.speed+"s "+t.options.animation,n.burgerTop.style.transition="all "+t.options.speed+"s "+t.options.animation,n.burgerBottom.style.transition="all "+t.options.speed+"s "+t.options.animation,o?(e.translate(n.burgerTop,0,"",t.options.burger.endY,"",45,"","",t.options.burger.endScale),e.translate(n.burgerBottom,0,"",t.options.burger.endY,"-",45,"-","",t.options.burger.endScale),e.translate(n.burger,0,"",0,"-",180,"")):(e.translate(n.burgerTop,0,"",0,"",0,"","",t.options.burger.startScale),e.translate(n.burgerBottom,0,"",0,"",0,"","",t.options.burger.startScale),t.options.reverse?e.translate(n.burger,0,"",0,"-",360,""):e.translate(n.burger,0,"",0,"-",0,"")),setTimeout(function(){n.burger.style.transition="none",n.burgerTop.style.transition="none",n.burgerBottom.style.transition="none",o?t.options.reverse=!0:(e.translate(n.burger,0,"",0,"-",0,""),t.options.reverse=!1)},1e3*t.options.speed)}}}]).factory("$nlDrawer",["$nlConfig","$nlBurger","$nlHelpers","$nlElements",function(t,e,n,o){var i={init:function(e){t.options=n.merge(t.options,e),o.body=document.body,o.bodyH=new Hammer(o.body),o.swipe=document.getElementById("nlSwipe"),o.swipeH=new Hammer(o.swipe),o.drawer=document.getElementById("nlDrawer"),o.drawerH=new Hammer(o.drawer),o.drawerDimm=document.getElementById("nlDimm"),o.drawerDimmH=new Hammer(o.drawerDimm),o.burger=document.getElementById("nlBurger"),o.burgerTop=document.getElementById("burger-top"),o.burgerBottom=document.getElementById("burger-bottom"),t.deviceW=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t.deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t.options.modifyViewContent&&(o.viewContent=document.getElementById("nlContent"),o.viewContentH=new Hammer(o.viewContent),o.viewContent.style["margin-top"]=t.options.topBarHeight+"px",o.viewContent.style["min-height"]=t.deviceH-t.options.topBarHeight+"px",o.viewContent.style.width=t.deviceW+"px"),t.options.useActionButton&&(o.actionPanel=document.getElementById("nlActionButton"),o.actionPlus=document.getElementById("nlPlus")),t.maxWidth=t.options.maxWidth>t.deviceW-56?t.deviceW-56:t.options.maxWidth,n.translate(o.drawer,t.maxWidth,"-",0,"",0,"",t.maxWidth),window.onresize=function(e){t.deviceW=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t.deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t.options.modifyViewContent&&(o.viewContent.style.width=t.deviceW+"px",o.viewContent.style["min-height"]=t.deviceH-t.options.topBarHeight+"px"),t.maxWidth=t.options.maxWidth>t.deviceW-56?t.deviceW-56:t.options.maxWidth,i.openned?n.translate(o.drawer,0,"",0,"",0,"",t.maxWidth):n.translate(o.drawer,t.maxWidth,"-",0,"",0,"",t.maxWidth)},o.drawerH.on("panleft panright",function(t){i.openned&&i.move(t,!0)}),o.drawerDimmH.on("panleft panright",function(t){i.openned&&i.move(t)}),o.swipeH.on("panright panleft",function(t){i.move(t)}),i.touchEnd(o.swipe),i.touchEnd(o.drawer),i.touchEnd(o.drawerDimm)},show:function(){o.drawer.style.transition="all "+t.options.speed+"s "+t.options.animation,t.maxWidth=t.options.maxWidth>t.deviceW-56?t.deviceW-56:t.options.maxWidth,n.translate(o.drawer,0,"",0,"",0,"",t.maxWidth),o.drawerDimm.style.transition="all "+t.options.speed+"s "+t.options.animation,o.drawerDimm.style.visibility="visible",o.drawerDimm.style.opacity="1",i.openned=!0,t.options.reverse=!0,e.toggle(!0)},hide:function(){o.drawer.style.transition="all "+t.options.speed+"s "+t.options.animation,n.translate(o.drawer,t.maxWidth,"-",0,"",0,""),o.drawerDimm.style.transition="all "+t.options.speed+"s "+t.options.animation,o.drawerDimm.style.visibility="hidden",o.drawerDimm.style.opacity="0",i.openned&&e.toggle(!1),i.togglePlus(!0),i.openned=!1},toggle:function(){i.openned?i.hide():i.show()},move:function(r,s){t.options.direction="panleft"===r.type?"left":"right";var a=r.center.x-t.maxWidth;s&&(t.options.holdPos=t.options.holdPos?t.options.holdPos:a,a+=Math.abs(t.options.holdPos)),a=0>a?a:0;var l=t.options.maxWidth-Math.abs(a),d=(l/(t.options.maxWidth/100)/100).toFixed(2);d=1>d?d:1,e.animate(a),o.drawerDimm.style.transition="none",o.drawerDimm.style.visibility="visible",o.drawerDimm.style.opacity=d,o.drawer.style.transition="none",t.maxWidth=t.options.maxWidth>t.deviceW-56?t.deviceW-56:t.options.maxWidth,n.translate(o.drawer,a,"",0,"",0,"",t.maxWidth),i.openned=!0,r.isFinal?("left"===t.options.direction?i.hide():i.show(),t.options.holdPos=null,t.options.endTrue=!1):t.options.endTrue=!0},touchEnd:function(e){t.onTouch="ontouchstart"in window?!0:!1,t.onTouch?e.addEventListener("touchend",function(t){n(t,!0)},!1):e.addEventListener("mouseup",function(t){n(t,!1)},!1);var n=function(e,n){var o=n?e.changedTouches[0]:e,r=o.clientX>t.options.maxWidth/2,s="left"===t.options.direction,a="right"===t.options.direction,l=t.options.endTrue;r&&s&&l||r&&a&&l?i.show():(!r&&s&&l||!r&&a&&l)&&i.hide(),t.options.direction=!1,t.options.endTrue=!1,t.options.holdPos=null,e.preventDefault()}},set:function(e){var o=t.options;t.options=n.merge(o,e)},togglePlus:function(e){t.options.useActionButton&&(o.drawerDimm.style.transition="all "+t.options.speed+"s "+t.options.animation,i.plusActive||e?(i.plusActive=!1,o.burger.style["z-index"]="1106",o.drawerDimm.style.visibility="hidden",o.drawerDimm.style.opacity="0",o.actionPlus.style["z-index"]="1104",o.actionPanel.classList.remove("active")):(i.plusActive=!0,o.burger.style["z-index"]="1104",o.actionPlus.style["z-index"]="1106",o.actionPanel.classList.add("active"),setTimeout(function(){o.drawerDimm.style.visibility="visible",o.drawerDimm.style.opacity="1"},100)))}};return i}]).factory("$nlRefresh",["$nlConfig","$nlHelpers","$nlElements",function(t,e,n){var o={init:function(){t.onTouch="ontouchstart"in window?!0:!1,n.topbar=document.getElementById("nlTopbar"),n.topbarH=new Hammer(n.topbar),n.refEl=document.getElementById("nlRefresh"),n.refIcon=document.getElementById("reload-icon"),n.refIcon.style.transition="all "+t.options.speed+"s "+t.options.animation,t.syncTrue=!1,t.scroll.top=0,t.center=t.deviceW/2-n.refEl.offsetWidth/2,n.topbarH.on("pan",function(t){o.move(t)}),o.touchEnd(n.body)},move:function(o){if(t.center=t.deviceW/2-n.refEl.offsetWidth/2,!t.syncing){n.refEl.style.transition="none";var i=Math.floor(t.deviceH/2),r=100/t.deviceH*o.center.y;if(o.center.y<i){t.syncTrue=!1;var s=r/2*(i/100),a=2*r*.005,l=.36*(i/100*o.center.y);n.refIcon.style.transition="none",n.refIcon.style.fill=t.options.refresh.defaultColor,e.translate(n.refIcon,"","","","","","","","","",a),e.translate(n.refEl,t.center,"",s,"",l)}else{n.refIcon.style.transition="fill "+4*t.options.speed+"s "+t.options.animation,t.syncTrue=!0;var r=i/100*(o.center.y-i),d=100/t.deviceH*o.center.y,c=100/(t.deviceH/2)*(o.center.y-i),s=d/2*(i/100);s-=s/100*c/3.5;var l=.36*(i/100*o.center.y);n.refIcon.style.fill=t.options.refresh.activeColor,e.translate(n.refIcon,"","","","","","","","","","1"),e.translate(n.refEl,t.center,"",s,"",l)}}},touchEnd:function(i){t.onTouch?i.addEventListener("touchend",function(t){r(t,!0)},!1):i.addEventListener("mouseup",function(t){r(t,!1)},!1);var r=function(i,r){var s=Math.floor(t.deviceH/2),a=r?i.changedTouches[0]:i;setTimeout(function(){if(n.refEl.style.transition="all "+t.options.speed/2+"s "+t.options.animation,a.clientY>s&&t.syncTrue&&!t.syncing){t.syncTrue=!1,t.syncing=!0,t.nlRefresh.ended=!1,o.callback();var i=0,r=0,l=.36*(s/100*(a.clientY-s))+360;t.nlRefresh.minY=t.options.topBarHeight+t.options.topBarHeight/3,e.translate(n.refEl,t.center,"",t.nlRefresh.minY,"",l,""),setTimeout(function(){n.refEl.style.transition="all "+t.options.speed/2+"s linear";var o=setInterval(function(){if(t.nlRefresh.ended)clearInterval(o);else{var s=l+r;e.translate(n.refEl,t.center,"",t.nlRefresh.minY,"",s,""),i+=.1,r+=6+i}},25)},1e3*t.options.speed)}else n.refEl.style.transition="all "+t.options.speed+"s "+t.options.animation,e.translate(n.refEl,t.center,"",0,"",0,""),t.syncTrue=!1,t.syncing=!1},50)}},callback:function(){setTimeout(function(){t.syncEndTrue()},2500)},syncEnd:function(){t.nlRefresh.ended=!0,setTimeout(function(){n.refEl.style.transition="all "+t.options.speed/2+"s "+t.options.animation,e.translate(n.refEl,t.center,"",t.nlRefresh.minY,"",0,"","","1.2")},100),setTimeout(function(){e.translate(n.refEl,t.center,"",t.nlRefresh.minY,"",0,"","","0")},200),setTimeout(function(){e.translate(n.refEl,t.center,"",0,"",0,"","","0")},300),t.syncTrue=!1,t.syncing=!1}};return o}]).factory("$nlToast",["$nlConfig","$nlHelpers","$nlElements",function(t,e,n){var o={init:function(i){t.options=e.merge(t.options,i),n.toast=document.getElementById("nlToast"),n.toastH=new Hammer(n.toast),n.toastH.on("panleft panright",function(t){o.move(t)}),o.touchEnd(n.toast)},show:function(i,r,s,a,l){t.runnigTimeout&&clearTimeout(t.runnigTimeout),console.log(t.runnigTimeout),"top"===r?(n.toast.style.top="75px",n.toast.style.bottom="auto"):(n.toast.style.top="",n.toast.style.bottom="1rem"),"function"==typeof s?o.trueCb=s:o.trueCb=function(){},"function"==typeof a?o.falseCb=a:o.falseCb=function(){},i&&(n.toast.innerHTML=i),"top"===r?(n.toast.style.transition="none",e.translate(n.toast,0,"",t.deviceH,"-",0,"")):(n.toast.style.transition="none",e.translate(n.toast,0,"",t.deviceH,"",0,"")),setTimeout(function(){n.toast.style.transition="all "+t.options.speed/2+"s "+t.options.animation,e.translate(n.toast,0,"",0,"",0,"")},100),l&&(t.runnigTimeout=setTimeout(function(){o.hide(!0)},l))},center:function(){n.toast.style.transition="all "+t.options.speed/2+"s "+t.options.animation,e.translate(n.toast,0,"",0,"",0,"")},right:function(){o.trueCb(),n.toast.style.transition="all "+t.options.speed/2+"s "+t.options.animation,e.translate(n.toast,t.deviceW,"",0,"",0,""),setTimeout(function(){o.hide()},t.options.speed/2*1e3)},left:function(){o.falseCb(),n.toast.style.transition="all "+t.options.speed/2+"s "+t.options.animation,e.translate(n.toast,t.deviceW,"-",0,"",0,""),setTimeout(function(){o.hide()},t.options.speed/2*1e3)},hide:function(o){console.log(o),o?n.toast.style.transition="all "+t.options.speed+"s "+t.options.animation:n.toast.style.transition="none",setTimeout(function(){e.translate(n.toast,0,"",t.deviceH,"",0,"")},100)},move:function(i){n.toast.style.transition="none",o.direction="panleft"===i.type?"left":"right";var r=i.center.x-t.deviceW;o.holdPos=o.holdPos?o.holdPos:r,r+=Math.abs(o.holdPos),e.translate(n.toast,r,"",0,"",0),i.isFinal?("left"===o.direction?o.left():o.right(),o.holdPos=null,o.endTrue=!1):o.endTrue=!0},touchEnd:function(e){t.onTouch="ontouchstart"in window?!0:!1,t.onTouch?e.addEventListener("touchend",function(t){n(t,!0)},!1):e.addEventListener("mouseup",function(t){n(t,!1)},!1);var n=function(e,n){var i=n?e.changedTouches[0]:e,r=(i.clientX>t.deviceW/2,"left"===o.direction,"right"===o.direction,o.endTrue);r&&o.center(),o.direction=!1,o.endTrue=!1,o.holdPos=null,e.preventDefault()}},trueCb:function(){console.log("True Callback")},falseCb:function(){console.log("False Callback")}};return o}]).factory("$nlMenu",["$nlConfig","$nlHelpers","$nlElements",function(t,e,n){var o={openned:!1,init:function(){n.menu=document.getElementById("nlMenu"),n.menuContent=n.menu.children[1],n.bodyH.on("tap",function(t){console.log(o.openned),o.openned&&o.hide()})},show:function(){n.menuContent.style.visibility="visible",n.menuContent.style.opacity="1",e.translate(n.menuContent,0,"",0,"",0),setTimeout(function(){o.openned=!0},50)},hide:function(){n.menuContent.style.visibility="hidden",n.menuContent.style.opacity="0",e.translate(n.menuContent,0,"",0,"",0),o.openned=!1}};return o}]);