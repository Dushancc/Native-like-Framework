angular.module("nativeDrawer",[]).factory("$nativeDrawer",[function(){var t,e,n,o,i,a,s,r,l,d,m,p,u,c={open:!1,plusActive:!1,holdPos:null,reverse:!1,options:{maxWidth:300,topBarHeight:0,speed:.2,animation:"ease-out",modifyViewContent:!1,useActionButton:!1,burger:{endY:6,startScale:1,endScale:.7}},show:function(){i.style.transition="all "+c.options.speed+"s "+c.options.animation,c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(i,0,"",0,"",0,"",c.maxWidth),s.style.transition="all "+c.options.speed+"s "+c.options.animation,s.style.visibility="visible",s.style.opacity="1",c.open=!0,c.reverse=!0,c.burger.toggle(!0)},hide:function(){i.style.transition="all "+c.options.speed+"s "+c.options.animation,c.translate(i,c.maxWidth,"-",0,"",0,""),s.style.transition="all "+c.options.speed+"s "+c.options.animation,s.style.visibility="hidden",s.style.opacity="0",c.open&&c.burger.toggle(!1),c.open=!1},toggle:function(){c.open?c.hide():c.show()},move:function(t,e){c.direction="panleft"===t.type?"left":"right";var n=t.center.x-c.maxWidth;e&&(c.holdPos=c.holdPos?c.holdPos:n,n+=Math.abs(c.holdPos)),n=0>n?n:0;var o=c.maxWidth-Math.abs(n),a=(o/(c.maxWidth/100)/100).toFixed(2);a=1>a?a:1,c.burger.animate(n),s.style.visibility="visible",s.style.opacity=a,s.style.webkitTransform="translate(0,0) translateZ(0)",i.style.transition="none",c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(i,n,"",0,"",0,"",c.maxWidth),c.open=!0,t.isFinal?("left"===c.direction?c.hide():c.show(),c.holdPos=null,c.endTrue=!1):c.endTrue=!0},translate:function(t,e,n,o,i,a,s,r,l,d){var e=e||0,o=o||0,n=n||"",i=i||"",s=s||"",r=r||!1,l=l?"scale3d("+l+",1,1)":"",m=t;"burger-top"===m.id?m.style.transformOrigin="100% 100%":"burger-bottom"===m.id&&(m.style.transformOrigin="100% 0%"),m.style.transform="translate3d("+n+e+"px, "+i+o+"px, 0) rotate3d( 0, 0, 1, "+s+a+"deg ) "+l,m.style.webkitTransform="translate("+n+e+"px, "+i+o+"px) translateZ(0) rotate("+s+a+"deg) "+l,r&&(m.style.width=r+"px"),d&&(m.style.msTransform=m.style.MozTransform=m.style.OTransform="translateX("+n+e+"px) translateY("+i+o+"px) rotate("+s+a+"deg)")},touchEnd:function(t){t.addEventListener("mouseup",function(t){e(t,!1)},!1),t.addEventListener("touchend",function(t){e(t,!0)},!1);var e=function(t,e){var n=e?t.changedTouches[0]:t,o=n.clientX>c.maxWidth/2,i="left"===c.direction,a="right"===c.direction,s=c.endTrue;o&&i&&s||o&&a&&s?c.show():(!o&&i&&s||!o&&a&&s)&&c.hide(),c.direction=!1,c.endTrue=!1,c.holdPos=null,t.preventDefault()}},init:function(h){var y=c.merge(c.options,h);c.options=y,console.log("init drawer"),t=document.getElementById("swipe-stripe"),e=new Hammer(t),n=document.getElementById("cont"),o=new Hammer(n),i=document.getElementById("drawer"),a=new Hammer(i),s=document.getElementById("drawer-dimm"),r=new Hammer(s),m=document.getElementById("burger"),p=document.getElementById("burger-top"),u=document.getElementById("burger-bottom"),l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c.options.modifyViewContent&&(d=document.getElementById("view-content"),d.style.position="fixed",d.style.width=l+"px",d.style.height=deviceH-c.options.topBarHeight+"px",d.style.top=c.options.topBarHeight+"px"),c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(i,c.maxWidth,"-",0,"","0","",c.maxWidth),window.onresize=function(t){l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c.options.modifyViewContent&&(d.style.position="fixed",d.style.width=l+"px",d.style.height=deviceH-c.options.topBarHeight+"px"),c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,i.style.width=c.maxWidth+"px",c.open||c.translate(i,c.maxWidth,"-",0,"","0","","")},a.on("panleft panright",function(t){c.open&&c.move(t,!0)}),r.on("panleft panright",function(t){c.open&&c.move(t)}),e.on("panright panleft",function(t){c.move(t)}),c.touchEnd(t),c.touchEnd(i),c.touchEnd(s)},togglePlus:function(t){if(c.options.useActionButton){var e=document.getElementById("add-panel-switch"),n=document.getElementById("drawer-dimm");c.plusActive||t?(c.open||(n.style.visibility="hidden",n.style.opacity="0"),c.plusActive=!1,e.classList.remove("active")):(c.plusActive=!0,e.classList.add("active"),n.style.visibility="visible",n.style.opacity="1")}},burger:{animate:function(t){var e=c.maxWidth,n=e-Math.abs(t),o=Math.floor(100/e*n);if(o>0){var i=c.options.burger.startScale-Math.abs((1-c.options.burger.endScale)/100*o).toFixed(2),a=Math.floor(.45*o),s=Math.floor(c.options.burger.endY/100*o);s=y_pos_bottom=s<c.options.burger.endY?s:c.options.burger.endY;var r=Math.floor(1.8*o);c.reverse&&(r=180+(180-r)),m.style.transition="none",p.style.transition="none",u.style.transition="none",c.translate(m,0,"",0,"",r,"",!1),c.translate(p,0,"",s,"",a,"","",i),c.translate(u,0,"",y_pos_bottom,"-",a,"-","",i)}},toggle:function(t){m.style.transition="all "+c.options.speed+"s "+c.options.animation,p.style.transition="all "+c.options.speed+"s "+c.options.animation,u.style.transition="all "+c.options.speed+"s "+c.options.animation,t?(c.translate(p,0,"",c.options.burger.endY,"",45,"","",c.options.burger.endScale),c.translate(u,0,"",c.options.burger.endY,"-",45,"-","",c.options.burger.endScale),c.translate(m,0,"",0,"-",180,"")):(c.translate(p,0,"",0,"",0,"","",c.options.burger.startScale),c.translate(u,0,"",0,"",0,"","",c.options.burger.startScale),c.reverse?c.translate(m,0,"",0,"-",360,""):c.translate(m,0,"",0,"-",0,""));var e=1e3*c.options.speed;setTimeout(function(){m.style.transition="none",p.style.transition="none",u.style.transition="none",t?c.reverse=!0:(c.translate(m,0,"",0,"-",0,""),c.reverse=!1)},e)}},merge:function(t,e){var n={};for(var o in t)n[o]=t[o];for(var o in e)n[o]=e[o];return n}};return c}]);