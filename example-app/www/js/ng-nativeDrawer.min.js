angular.module("nativeDrawer",[]).factory("$nativeDrawer",[function(){var t,e,n,o,a,s,r,i,l,d,m,p,y,h={open:!1,plusActive:!1,holdingDrawerPosition:null,options:{maxWidth:300,topBarHeight:0,speed:.2,animation:"ease-out",modifyViewContent:!1,useActionButton:!1},show:function(){a.style.transition="all "+h.options.speed+"s "+h.options.animation,a.style.webkitTransform="translate(0,0)translateZ(0)",a.style.msTransform=a.style.MozTransform=a.style.OTransform="translateX(0)",a.style.boxShadow="0 0 10px rgba(0,0,0,0.4)",r.style.transition="all "+h.options.speed+"s "+h.options.animation,r.style.visibility="visible",r.style.opacity="1",h.open=!0,h.toggleBurger(!0)},hide:function(){a.style.transition="all "+h.options.speed+"s "+h.options.animation,a.style.webkitTransform="translate(-"+h.maxWidth+"px,0)translateZ(0)",a.style.msTransform=a.style.MozTransform=a.style.OTransform="translateX(-"+h.maxWidth+"px)",a.style.boxShadow="none",r.style.transition="all "+h.options.speed+"s "+h.options.animation,r.style.visibility="hidden",r.style.opacity="0",h.open=!1,h.toggleBurger(!1)},toggle:function(){h.open?h.hide():h.show()},move:function(t,e){h.direction="panleft"===t.type?"left":"right";var n=t.center.x-h.maxWidth;e&&(h.holdingDrawerPosition=h.holdingDrawerPosition?h.holdingDrawerPosition:n,n+=Math.abs(h.holdingDrawerPosition)),n=0>n?n:0;var o=h.maxWidth-Math.abs(n),s=(o/(h.maxWidth/100)/100).toFixed(2);s=1>s?s:1,h.animateBurger(n),r.style.visibility="visible",r.style.opacity=s,a.style.transition="none",a.style.webkitTransform="translate("+n+"px,0)translateZ(0)",a.style.msTransform=a.style.MozTransform=a.style.OTransform="translateX("+n+"px)",a.style.boxShadow="0 0 10px rgba(0,0,0,0.4)",h.open=!0,t.isFinal?("left"===h.direction?h.hide():h.show(),h.endTrue=!1,h.holdingDrawerPosition=null):h.endTrue=!0},animateBurger:function(t){var e=h.maxWidth,n=e-Math.abs(t),o=Math.floor(100/e*n);if(o>0){m.style.transition="none",p.style.transition="none",y.style.transition="none",console.log(o);var s=18,r=s-Math.floor(.06*o),i=Math.floor(.45*o),l=Math.floor(.3*o),d=Math.floor(.09*o);d=9>d?d:9;var f=Math.floor(.09*o),g=Math.floor(.26*o);g=26>g?g:26;var c=Math.floor(1.8*o);m.style.transform="translate3d(0px, 0px, 0) rotate3d(0,0,1,"+c+"deg)",m.style.webkitTransform="rotate("+c+"deg)",m.style.msTransform=a.style.MozTransform=a.style.OTransform="rotate("+c+"deg)",p.style.transform="translate3d("+l+"px, -"+d+"px, 0) rotate3d( 0, 0, 1, "+i+"deg )",p.style.webkitTransform="rotate("+i+"deg)",p.style.msTransform=a.style.MozTransform=a.style.OTransform="rotate("+i+"deg)",p.setAttribute("width",r),y.style.transform="translate3d(-"+f+"px, "+g+"px, 0) rotate3d( 0, 0, 1, -"+i+"deg )",y.style.webkitTransform="rotate(-"+i+"deg)",y.style.msTransform=a.style.MozTransform=a.style.OTransform="rotate(-"+i+"deg)",y.setAttribute("width",r)}},toggleBurger:function(t){m.style.transition="all 0.3s ease",p.style.transition="all 0.3s ease",y.style.transition="all 0.3s ease",t?(p.style.transform="translate3d(30px, -9px, 0) rotate3d( 0, 0, 1, 45deg )",p.style.webkitTransform="translate(30px, -9px) translateZ(0) rotate(45deg)",p.setAttribute("width",12),y.style.transform="translate3d(-9px, 26px, 0) rotate3d( 0, 0, 1, -45deg )",y.style.webkitTransform="translate(-9px, 26px) translateZ(0) rotate(-45deg)",y.setAttribute("width",12),m.style.transform="translate3d(0px, 0px, 0) rotate3d( 0, 0, 1, 180deg )",m.style.webkitTransform="translate(0px, 0px) translateZ(0) rotate(180deg)"):(p.style.transform="translate3d(0, 0, 0) rotate3d( 0, 0, 1, 0deg )",p.style.webkitTransform="translate(0, 0) translateZ(0) rotate(0deg)",p.setAttribute("width",18),y.style.transform="translate3d(0, 0, 0) rotate3d( 0, 0, 1, 0deg )",y.style.webkitTransform="translate(0, 0) translateZ(0) rotate(0deg)",y.setAttribute("width",18),m.style.transform="translate3d(0px, 0px, 0) rotate3d( 0, 0, 1, 0deg )",m.style.webkitTransform="translate(0px, 0px) translateZ(0) rotate(0deg)")},touchEnd:function(t){t.addEventListener("touchend",function(t){var e=t.changedTouches[0],n=e.clientX>h.maxWidth/2,o="left"===h.direction,a="right"===h.direction,s=h.endTrue;s&&(n&&o||n&&a?h.show():(!n&&o||!n&&a)&&h.hide()),h.direction=!1,h.endTrue=!1,h.holdingDrawerPosition=null,t.preventDefault()},!1)},init:function(f){var g=h.merge_options(h.options,f);h.options=g,console.log(h.options),console.log("init drawer"),t=document.getElementById("swipe-stripe"),e=new Hammer(t),n=document.getElementById("cont"),o=new Hammer(n),a=document.getElementById("drawer"),s=new Hammer(a),r=document.getElementById("drawer-dimm"),i=new Hammer(r),m=document.getElementById("burger"),p=document.getElementById("burger-top"),y=document.getElementById("burger-bottom"),l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),h.options.modifyViewContent&&(d=document.getElementById("view-content"),d.style.position="absolute",d.style.width=l+"px",d.style.height=deviceH-h.options.topBarHeight+"px",d.style.top=h.options.topBarHeight+"px"),h.maxWidth=h.options.maxWidth>l-56?l-56:h.options.maxWidth,a.style.width=h.maxWidth+"px",a.style.webkitTransform="translate(-"+h.maxWidth+"px,0)translateZ(0)",a.style.msTransform=a.style.MozTransform=a.style.OTransform="translateX(-"+h.maxWidth+"px)",window.onresize=function(){l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),h.options.modifyViewContent&&(d.style.position="absolute",d.style.width=l+"px",d.style.height=deviceH-h.options.topBarHeight+"px"),h.maxWidth=h.options.maxWidth>l-56?l-56:h.options.maxWidth,a.style.width=h.maxWidth+"px",h.open||(a.style.webkitTransform="translate(-"+h.maxWidth+"px,0)translateZ(0)",a.style.msTransform=a.style.MozTransform=a.style.OTransform="translateX(-"+h.maxWidth+"px)")},s.on("panleft panright",function(t){h.open&&h.move(t,!0)}),e.on("panright panleft",function(t){h.move(t)}),i.on("panleft panright",function(t){h.open&&h.move(t)}),h.touchEnd(t),h.touchEnd(a),h.touchEnd(r)},togglePlus:function(t){if(h.options.useActionButton){var e=document.getElementById("add-panel-switch"),n=document.getElementById("drawer-dimm");h.plusActive||t?(h.open||(n.style.visibility="hidden",n.style.opacity="0"),h.plusActive=!1,e.classList.remove("active")):(h.plusActive=!0,e.classList.add("active"),n.style.visibility="visible",n.style.opacity="1")}},merge_options:function(t,e){var n={};for(var o in t)n[o]=t[o];for(var o in e)n[o]=e[o];return n}};return h}]);