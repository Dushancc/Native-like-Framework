angular.module("nativeDrawer",[]).factory("$nativeDrawer",[function(){var t,e,n,i,o,a,r,s,l,d,m,p,u,c={open:!1,plusActive:!1,holdingDrawerPosition:null,burgerBackAnim:!1,options:{maxWidth:300,topBarHeight:0,speed:.2,animation:"ease-out",modifyViewContent:!1,useActionButton:!1,burger:{endY:6,startScale:1,endScale:.7}},show:function(){o.style.transition="all "+c.options.speed+"s "+c.options.animation,c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(o,0,"",0,"",0,"",c.maxWidth),r.style.transition="all "+c.options.speed+"s "+c.options.animation,r.style.visibility="visible",r.style.opacity="1",c.open=!0,c.burgerBackAnim=!0,c.toggleBurger(!0)},hide:function(){o.style.transition="all "+c.options.speed+"s "+c.options.animation,c.translate(o,c.maxWidth,"-",0,"",0,""),r.style.transition="all "+c.options.speed+"s "+c.options.animation,r.style.visibility="hidden",r.style.opacity="0",c.open&&c.toggleBurger(!1),c.open=!1},toggle:function(){c.open?c.hide():c.show()},move:function(t,e){c.direction="panleft"===t.type?"left":"right";var n=t.center.x-c.maxWidth;e&&(c.holdingDrawerPosition=c.holdingDrawerPosition?c.holdingDrawerPosition:n,n+=Math.abs(c.holdingDrawerPosition)),n=0>n?n:0;var i=c.maxWidth-Math.abs(n),a=(i/(c.maxWidth/100)/100).toFixed(2);a=1>a?a:1,c.animateBurger(n),r.style.visibility="visible",r.style.opacity=a,r.style.webkitTransform="translate(0,0) translateZ(0)",o.style.transition="none",c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(o,n,"",0,"",0,"",c.maxWidth),c.open=!0,t.isFinal?("left"===c.direction?c.hide():c.show(),c.holdingDrawerPosition=null,c.endTrue=!1):c.endTrue=!0},animateBurger:function(t){var e=c.maxWidth,n=e-Math.abs(t),i=Math.floor(100/e*n);if(i>0){var o=c.options.burger.startScale-Math.abs((1-c.options.burger.endScale)/100*i).toFixed(2),a=Math.floor(.45*i),r=Math.floor(c.options.burger.endY/100*i);r=y_pos_bottom=r<c.options.burger.endY?r:c.options.burger.endY;var s=Math.floor(1.8*i);c.burgerBackAnim&&(s=180+(180-s)),m.style.transition="none",p.style.transition="none",u.style.transition="none",c.translate(m,0,"",0,"",s,"",!1),c.translate(p,0,"",r,"",a,"","",o),c.translate(u,0,"",y_pos_bottom,"-",a,"-","",o)}},translate:function(t,e,n,i,o,a,r,s,l,d){var e=e||0,i=i||0,n=n||"",o=o||"",r=r||"",s=s||!1,l=l?"scale3d("+l+",1,1)":"",m=t;"burger-top"===m.id?m.style.transformOrigin="100% 100%":"burger-bottom"===m.id&&(m.style.transformOrigin="100% 0%"),m.style.transform="translate3d("+n+e+"px, "+o+i+"px, 0) rotate3d( 0, 0, 1, "+r+a+"deg ) "+l,m.style.webkitTransform="translate("+n+e+"px, "+o+i+"px) translateZ(0) rotate("+r+a+"deg) "+l,s&&(m.style.width=s+"px"),d&&(m.style.msTransform=m.style.MozTransform=m.style.OTransform="translateX("+n+e+"px) translateY("+o+i+"px) rotate("+r+a+"deg)")},toggleBurger:function(t){m.style.transition="all "+c.options.speed+"s "+c.options.animation,p.style.transition="all "+c.options.speed+"s "+c.options.animation,u.style.transition="all "+c.options.speed+"s "+c.options.animation,t?(c.translate(p,0,"",c.options.burger.endY,"",45,"","",c.options.burger.endScale),c.translate(u,0,"",c.options.burger.endY,"-",45,"-","",c.options.burger.endScale),c.translate(m,0,"",0,"-",180,"")):(c.translate(p,0,"",0,"",0,"","",c.options.burger.startScale),c.translate(u,0,"",0,"",0,"","",c.options.burger.startScale),c.burgerBackAnim?c.translate(m,0,"",0,"-",360,""):c.translate(m,0,"",0,"-",0,""));var e=1e3*c.options.speed;setTimeout(function(){m.style.transition="none",p.style.transition="none",u.style.transition="none",t?c.burgerBackAnim=!0:(c.translate(m,0,"",0,"-",0,""),c.burgerBackAnim=!1)},e)},touchEnd:function(t){t.addEventListener("mouseup",function(t){e(t,!1)},!1),t.addEventListener("touchend",function(t){e(t,!0)},!1);var e=function(t,e){var n=e?t.changedTouches[0]:t,i=n.clientX>c.maxWidth/2,o="left"===c.direction,a="right"===c.direction,r=c.endTrue;i&&o&&r||i&&a&&r?c.show():(!i&&o&&r||!i&&a&&r)&&c.hide(),c.direction=!1,c.endTrue=!1,c.holdingDrawerPosition=null,t.preventDefault()}},init:function(h){var g=c.merge_options(c.options,h);c.options=g,console.log("init drawer"),t=document.getElementById("swipe-stripe"),e=new Hammer(t),n=document.getElementById("cont"),i=new Hammer(n),o=document.getElementById("drawer"),a=new Hammer(o),r=document.getElementById("drawer-dimm"),s=new Hammer(r),m=document.getElementById("burger"),p=document.getElementById("burger-top"),u=document.getElementById("burger-bottom"),l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c.options.modifyViewContent&&(d=document.getElementById("view-content"),d.style.position="fixed",d.style.width=l+"px",d.style.height=deviceH-c.options.topBarHeight+"px",d.style.top=c.options.topBarHeight+"px"),c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,c.translate(o,c.maxWidth,"-",0,"","0","",c.maxWidth),window.onresize=function(){l=Math.max(document.documentElement.clientWidth,window.innerWidth||0),deviceH=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c.options.modifyViewContent&&(d.style.position="fixed",d.style.width=l+"px",d.style.height=deviceH-c.options.topBarHeight+"px"),c.maxWidth=c.options.maxWidth>l-56?l-56:c.options.maxWidth,o.style.width=c.maxWidth+"px",c.open||c.translate(o,c.maxWidth,"-",0,"","0","","")},a.on("panleft panright",function(t){c.open&&c.move(t,!0)}),s.on("panleft panright",function(t){c.open&&c.move(t)}),e.on("panright panleft",function(t){c.move(t)}),c.touchEnd(t),c.touchEnd(o),c.touchEnd(r)},togglePlus:function(t){if(c.options.useActionButton){var e=document.getElementById("add-panel-switch"),n=document.getElementById("drawer-dimm");c.plusActive||t?(c.open||(n.style.visibility="hidden",n.style.opacity="0"),c.plusActive=!1,e.classList.remove("active")):(c.plusActive=!0,e.classList.add("active"),n.style.visibility="visible",n.style.opacity="1")}},merge_options:function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n}};return c}]);